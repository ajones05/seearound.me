<?php
$address = Application_Model_Address::format($this->addressForm->getValues());
?>
<div class="loginCopyArea">
    <div class="rightBoxArea">
        <h2>See and Share What's Happening Near You</h2>
    </div> 
    <div class="leftBoxArea">
        <div class="users-popup">
            
        </div><!-- users-popup end -->
        <div class="regForm">

           <div class="fbImageMw">
                <span>Register Here or</span>
				<img id="facebookLogin" style="cursor: pointer;" src="<?php echo $this->baseUrl("www/images/signupFacebookButton.png"); ?>" alt="Sign Up" />
				<div class="clr"></div>
           </div>
           <p class="fbtext">
                *WeÂ´ll never post to facebook without your permission
           </p>
			<div id="regForm">
				<form id="reg_form" action="<?php echo $this->baseUrl('register'); ?>" class="form" method="post" name="reg_form">
					<ul class="frm">
						<li>
							<input id="Name" name="name" type="text" placeholder="Name" value="<?php echo $this->reg_form->name->getValue(); ?>" />
							<?php echo $this->reg_form->name->renderErrors(); ?>
						</li>
						<li>
							<input id="Email_id" name="email" type="text" placeholder="Email address" value="<?php echo $this->reg_form->email->getValue(); ?>" />
							<?php echo $this->reg_form->email->renderErrors(); ?>
						</li>
						<li>
							<input id="Password" name="password" type="password" placeholder="Password" value="" />
							<?php echo $this->reg_form->password->renderErrors(); ?>
						</li>
						<li>
							<input id="Re-password" name="repassword" type="password" placeholder="Re-password" value="" />
							<?php echo $this->reg_form->repassword->renderErrors(); ?>
						</li>
						<li>
<input id="Location" name="address" readonly="true" type="text" placeholder="User Location" value="<?php echo $address; ?>">
							<img class="myLoc" src="<?php echo $this->baseUrl("www/images/icn-location.gif"); ?>" alt="My Location" />
							<input type="hidden" name="latitude" value="<?php echo $this->addressForm->latitude->getValue(); ?>">
							<input type="hidden" name="longitude" value="<?php echo $this->addressForm->longitude->getValue(); ?>">
							<input type="hidden" name="street_name" value="<?php echo $this->addressForm->street_name->getValue(); ?>">
							<input type="hidden" name="street_number" value="<?php echo $this->addressForm->street_number->getValue(); ?>">
							<input type="hidden" name="city" value="<?php echo $this->addressForm->city->getValue(); ?>">
							<input type="hidden" name="state" value="<?php echo $this->addressForm->state->getValue(); ?>">
							<input type="hidden" name="country" value="<?php echo $this->addressForm->country->getValue(); ?>">
							<input type="hidden" name="zip" value="<?php echo $this->addressForm->zip->getValue(); ?>">
<?php if ($this->addressForm->isErrors()): ?>
<div class="errors">
<?php echo implode("\n", $this->addressForm->getErrorMessages()); ?>
</div>
<?php endif; ?>
						</li>
						<li class="clr"></li>
					</ul>
					<div class="terms">By clicking Register, you agree to the <a class="tems-of-service-popup" href="<?php echo $this->url(array(), 'terms'); ?>">Terms of Service</a><span> and </span><a class="privacy-policy-popup" href="<?php echo $this->url(array(), 'privacy'); ?>">Privacy Policy</a>.</div>
					<input type="submit" class="btnBlueRpt regSub" value="Register" style="width: 100%; padding:6px 0px 7px; background-color: #3366cc;color: #FFFFFF;" />
				</form>
			</div>

    </div>
	<div class="clr"></div>
    </div>
    
	<div class="clr"></div>
</div>
<script>
$(function(){
	var formData = formData||{},
		form = $('#reg_form')
		userAddress = formData.address?formData.address:geolocation[2],
		userPosition = formData.latitude?
			new google.maps.LatLng(formData.latitude,formData.longitude):
			new google.maps.LatLng(geolocation[0],geolocation[1]);

	$('[name=address],.myLoc', form).click(function(){
		var $address = $('[name=address]', form),
			$latitude = $('[name=latitude]', form),
			$longitude = $('[name=longitude]', form);

		editLocationDialog({
			mapZoom: 10,
			markerIcon: baseUrl + 'www/images/man.png',
			inputPlaceholder: 'Enter your Address',
			submitText: 'Use This Address',
			defaultAddress: userAddress,
			center: userPosition,
			infoWindowContent: function(address){
				if ($.trim(address) === ''){
					address = '<i>undefined</i>';
				}

				return '<div class="userLocation"><div>Address:</div><div>' + address + '</div></div>';
			},
			submit: function(dialogEvent, position, place){
				var data = {
					latitude: position.lat(),
					longitude: position.lng()
				};

				if (place){
					data = $.extend(data, parsePlaceAddress(place));
				}

				$address.val(place?place.formatted_address:'');
				$latitude.val(position.lat());
				$longitude.val(position.lng());
				$('[name=street_name]', form).val(data.street_name?data.street_name:'');
				$('[name=street_number]', form).val(data.street_number?data.street_number:'');
				$('[name=city]', form).val(data.city?data.city:'');
				$('[name=state]', form).val(data.state?data.state:'');
				$('[name=country]', form).val(data.country?data.country:'');
				$('[name=zip]', form).val(data.zip?data.zip:'');

				$(dialogEvent.target).dialog('close');
			}
		});
	});
});
</script>
