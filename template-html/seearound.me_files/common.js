function editLocationDialog(e){var t=$("<form/>").attr({autocomplete:!1}).hide();if(e.cancelButton===!0)var a=$("<input/>",{type:"button"}).addClass("cancel").val("Cancel").prependTo(t);$("body").css({overflow:"hidden"}),$("<div/>").addClass("location-dialog").append($("<div/>",{id:"map-canvas"}),$("<div/>").addClass("panel").append(t.append($("<input/>",{type:"text",name:"address",placeholder:e.inputPlaceholder}),$("<input/>",{type:"button"}).val("").addClass("search"),$("<input/>",{type:"button"}).val(e.submitText).addClass("save")))).appendTo("body").dialog({modal:!0,resizable:!1,drag:!1,width:980,height:500,dialogClass:"dialog colorbox",beforeClose:function(t,a){"function"==typeof e.beforeClose&&e.beforeClose(t,a),$(".pac-container").remove(),$("body").css({overflow:"visible"}),$(t.target).dialog("destroy").remove()},open:function(o){var n=!1,i=$(".search",t).attr("clicked",!1),r=$("[name=address]",t).on("input",function(){i.attr("disabled",!1)}),s=new google.maps.places.Autocomplete(r.get(0)),d=new google.maps.Geocoder,l=function(t){if("undefined"==typeof t.place)return function(){d.geocode({latLng:t.position},function(e,a){return t.place=a===google.maps.GeocoderStatus.OK?e[0]:!1,l(t)})}();if(n=t.place,t.update){var a=t.position?t.position:n.geometry.location;$.inArray("map",t.update)>=0&&c.setCenter(a),$.inArray("marker",t.update)>=0&&m.setPosition(a)}var o=n?n.formatted_address:"";g.setContent(e.infoWindowContent(o)),g.open(c,m),setGoogleMapsAutocompleteValue(r.val(o),o)},u=function(){var e=$.trim(r.val());return""===e?(r.focus(),!1):(i.add(r).attr("disabled",!0),void d.geocode({address:e},function(e,t){var a=r;t===google.maps.GeocoderStatus.OK?(l({place:e[0],update:["map","marker"]}),a.add(i)):(alert("Sorry! We are unable to find this location."),n=!1),a.attr("disabled",!1)}))},c=new google.maps.Map(document.getElementById("map-canvas"),{zoom:e.mapZoom,center:e.center,draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!0,styles:[{featureType:"poi",stylers:[{visibility:"off"}]}]}),m=new google.maps.Marker({position:e.center,icon:e.markerIcon,draggable:!1}),g=new google.maps.InfoWindow({maxWidth:220});google.maps.event.addListener(c,"idle",function(){m.setMap(c)}),google.maps.event.addListener(c,"dragstart",function(){g.close()}),google.maps.event.addListener(c,"zoom_changed",function(){g.close()}),google.maps.event.addListener(c,"click",function(e){g.close(),l({position:e.latLng,update:["marker"]})}),google.maps.event.addListener(m,"dragstart",function(){g.close()}),google.maps.event.addListener(m,"dragend",function(e){l({position:e.latLng})}),d.geocode({latLng:e.center},function(a,o){if(o==google.maps.GeocoderStatus.OK){var i=a[0].formatted_address;r.val(i),g.setContent(e.infoWindowContent(i)),g.open(c,m),n=a[0]}t.show(),c.setOptions({draggable:!0,zoomControl:!0,scrollwheel:!0,disableDoubleClickZoom:!1}),m.setDraggable(!0)}),google.maps.event.addListener(s,"place_changed",function(){var e=s.getPlace();return e&&"undefined"!=typeof e.geometry?void l({place:e,update:["map","marker"]}):!1}),1==e.cancelButton&&a.click(function(){$(o.target).dialog("close")}),i.on("click",function(){$(this).is(":disabled")||($(this).attr("clicked",!0),t.submit())}),t.submit(function(e){e.preventDefault(),1==i.attr("clicked")?(i.attr("clicked",!1),u()):(r.attr("disabled",!0),setTimeout(function(){return r.attr("disabled",!1),i.is(":disabled")?!0:void u()},200))}),$(".save",t).click(function(){$("input",t).attr("disabled",!0),e.submit(c,o,m.getPosition(),n)})}})}function setGoogleMapsAutocompleteValue(e,t){e.blur(),$(".pac-container .pac-item").addClass("hidden"),setTimeout(function(){e.val(t).change()},.1)}function locationTimezone(e,t){$.ajax("https://maps.googleapis.com/maps/api/timezone/json?location="+e.lat()+","+e.lng()+"&timestamp="+getTimestamp()).done(function(e){if("OK"===e.status)return t(e.timeZoneId);var a=$("<div/>").appendTo("body"),o=$("<select/>",{id:"locationTimezone"}).on("change",function(){a.dialog("close")}).append($("<option/>",{text:"Select One"}).val(""));for(var n in timizoneList)o.append($("<option/>",{text:timizoneList[n]}).val(n));a.append($("<label/>",{"for":"locationTimezone"}).text("Time zone"),o).dialog({title:"Cannot determine location time zone",width:450,beforeClose:function(e){return $(e.target).dialog("destroy").remove(),t($("#locationTimezone").val())}})})}function getTimestamp(){return Math.round((new Date).getTime()/1e3).toString()}function formatOutputDate(e){return monthNames[e.getMonth()]+" "+e.getDate()+" at "+formatTime(e)}function formatTime(e){var t=e.getHours(),a=e.getMinutes(),o=t>=12?"pm":"am";t%=12,t=t?t:12,a=10>a?"0"+a:a;var n=t+":"+a+o;return n}function resetTimeAgo(){$.timeago.settings.strings.seconds="Just now",$.timeago.settings.strings.minute="1 minute",$.timeago.settings.strings.hour="1 hour",$.timeago.settings.strings.hours="%d hours",$.timeago.settings.strings.day="Yesterday",$.timeago.settings.strings.month="1 month",$.timeago.settings.strings.year="1 year"}function userMessageDialog(e){$("body").css({overflow:"hidden"}),$("<div/>").addClass("message-dialog location-dialog").append($("<img/>",{src:baseUrl+"www/images/mail_send.gif"}),$("<span/>",{"class":"locppmsgimg"}).text("Send Message"),$("<div/>",{"class":"row-content"}).append($("<form/>").append($("<div/>").append($("<input/>",{type:"text",name:"subject",placeholder:"Please enter subject..."})),$("<div/>").append($("<textarea/>",{name:"message",placeholder:"Please enter message..."})),$("<div/>").append($("<input/>",{type:"submit",value:"Send","class":"btnBlueRpt"}),$("<input/>",{type:"button",value:"Cancel","class":"btnBlueRpt"}).click(function(){$(".message-dialog").dialog("close")})).addClass("panel")))).appendTo($("body")).dialog({modal:!0,resizable:!1,drag:!1,width:540,height:260,dialogClass:"dialog colorbox",beforeClose:function(e){$("body").css({overflow:"visible"}),$(e.target).dialog("destroy").remove()},open:function(t){var a=t.target;$("form",a).on("submit",function(t){t.preventDefault();var o=!1,n=$(this),i=n.find("[name=subject]"),r=i.val(),s=n.find("[name=message]");if(body=s.val(),""===$.trim(r)&&(i.addClass("error"),o=!0),""===$.trim(body)&&(s.addClass("error"),o=!0),o)return!1;n.find("input,textarea").attr("disabled",!0);ajaxJson({url:baseUrl+"message/send",data:{subject:r,message:body,user_id:e},done:function(){$(a).addClass("success").empty().append($("<img/>",{src:baseUrl+"www/images/correct.gif"}),$("<span/>").text("Message sent"))}})})}})}function ajaxJson(e,t){"string"==typeof e?t.url=e:"object"==typeof e&&(t=e),t.dataType="json";var a=$.ajax($.extend(t,{type:"POST"})).done(function(e,a,o){var n="object"==typeof e;return n&&0!=e.status?"function"==typeof t.done?t.done(e,a,o):void 0:("function"==typeof t.fail&&t.fail(e,a,o),t.failMessage!==!1&&alert(n?e.message:ERROR_MESSAGE),!1)}).fail(function(e,a){return 0==e.readyState||0==e.status?!0:("function"==typeof t.fail&&t.fail({},a,e),void(t.failMessage!==!1&&alert(ERROR_MESSAGE)))});return a}function setCookie(e,t,a){var o=new Date;o.setTime(o.getTime()+864e5*a),document.cookie=e+"="+t+"; expires="+o.toUTCString()}function getCookie(e){for(var e=e+"=",t=document.cookie.split(";"),a=0;a<t.length;a++){for(var o=t[a];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""}function userAddressTooltip(e,t){return'<div class="location-dialog__user"><img src="'+t+'" /><div class="address">'+e+"</div></div>"}function parsePlaceAddress(e){var t={},a={street_number:"street_number",route:"street_name",locality:"city",administrative_area_level_1:"state",country:"country",postal_code:"zip"};for(var o in e.address_components){var n=e.address_components[o],i=n.types[0];a[i]&&(t[a[i]]="route"==i?n.long_name:n.short_name)}return t}function keyCode(e){return e.keyCode||e.which}function getDistance(e,t){if(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),t[0]=parseFloat(t[0]),t[1]=parseFloat(t[1]),e[0]==t[0]&&e[1]==t[1])return 0;var a=e[1]-t[1],o=Math.sin(e[0]*Math.PI/180)*Math.sin(t[0]*Math.PI/180)+Math.cos(e[0]*Math.PI/180)*Math.cos(t[0]*Math.PI/180)*Math.cos(a*Math.PI/180),n=180*Math.acos(o)/Math.PI*60*1.1515;return n}var timezoneOffset=(new Date).getTimezoneOffset(),monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],ERROR_MESSAGE="Internal server error";Object.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a},function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(){var t=a(this),r=i.settings;return isNaN(t.datetime)||(0==r.cutoff||n(t.datetime)<r.cutoff)&&e(this).text(o(t.datetime)),this}function a(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:i.datetime(t)});var a=e.trim(t.text());i.settings.localeTitle?t.attr("title",t.data("timeago").datetime.toLocaleString()):!(a.length>0)||i.isTime(t)&&t.attr("title")||t.attr("title",a)}return t.data("timeago")}function o(e){return i.inWords(n(e))}function n(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return o(t instanceof Date?t:"string"==typeof t?e.timeago.parse(t):"number"==typeof t?new Date(t):e.timeago.datetime(t))};var i=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"1 day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function a(a,n){var i=e.isFunction(a)?a(n,t):a,r=o.numbers&&o.numbers[n]||n;return i.replace(/%d/i,r)}var o=this.settings.strings,n=o.prefixAgo,i=o.suffixAgo;this.settings.allowFuture&&0>t&&(n=o.prefixFromNow,i=o.suffixFromNow);var r=Math.abs(t)/1e3,s=r/60,d=s/60,l=d/24,u=l/365,c=45>r&&a(o.seconds,Math.round(r))||90>r&&a(o.minute,1)||45>s&&a(o.minutes,Math.round(s))||90>s&&a(o.hour,1)||24>d&&a(o.hours,Math.round(d))||42>d&&a(o.day,1)||30>l&&a(o.days,Math.round(l))||45>l&&a(o.month,1)||365>l&&a(o.months,Math.round(l/30))||1.5>u&&a(o.year,1)||a(o.years,Math.round(u)),m=o.wordSeparator||"";return void 0===o.wordSeparator&&(m=" "),e.trim([n,c,i].join(m))},parse:function(t){var a=e.trim(t);return a=a.replace(/\.\d+/,""),a=a.replace(/-/,"/").replace(/-/,"/"),a=a.replace(/T/," ").replace(/Z/," UTC"),a=a.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(a)},datetime:function(t){var a=i.isTime(t)?e(t).attr("datetime"):e(t).attr("title");return i.parse(a)},isTime:function(t){return"time"===e(t).get(0).tagName.toLowerCase()}});var r={init:function(){var a=e.proxy(t,this);a();var o=i.settings;o.refreshMillis>0&&(this._timeagoInterval=setInterval(a,o.refreshMillis))},update:function(a){e(this).data("timeago",{datetime:i.parse(a)}),t.apply(this)},updateFromDOM:function(){e(this).data("timeago",{datetime:i.parse(i.isTime(this)?e(this).attr("datetime"):e(this).attr("title"))}),t.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};e.fn.timeago=function(e,t){var a=e?r[e]:r.init;if(!a)throw new Error("Unknown function name '"+e+"' for timeago");return this.each(function(){a.call(this,t)}),this},document.createElement("abbr"),document.createElement("time")});